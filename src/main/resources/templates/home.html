<!doctype html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Black Company Simulator | Home</title>
  
  <link rel="stylesheet" th:href="@{/css/home-back.css}" href="/css/home-back.css">
  <link rel="stylesheet" th:href="@{/css/home-button.css}" href="/css/home-button.css">

</head>
<body>
  <main class="stage" aria-label="ãƒ›ãƒ¼ãƒ ç”»é¢">
    <div class="salaryman" aria-hidden="true"></div>
    <div class="scanlines" aria-hidden="true"></div>

    <div class="wrap">

      <section class="home-grid layout-v2" aria-label="ãƒ›ãƒ¼ãƒ UI">

        <!-- ä¸Šä¸­å¤®ï¼šéƒ¨ç½²ï¼‹åå‰ã®ãƒ—ãƒ¬ãƒ¼ãƒˆ -->
        <header class="nameplate">
          <div class="dept" th:text="${user.department}">å–¶æ¥­éƒ¨</div>
          <div class="uname" >çŸ³é»’ã€€é›„ä¸‰ï¼ˆ36ï¼‰</div>
        </header>
		
		<!-- ä¸‹ä¸­å¤®ï¼šå‡ºå‹¤ã™ã‚‹ï¼ˆå¤§ãƒœã‚¿ãƒ³ï¼‰ -->
		<button class="btn-briefcase" style="--label-top:72%; --label-left:50%;">
		  <span class="label">å‡ºå‹¤ã™ã‚‹</span>
		</button>

        <!-- ä¸­å¤®ï¼šã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ -->
        <div class="center-char">
          <div class="char">
            <img th:src="@{${user.character} == 'restaurant' ? '/images/restaurant.png' : '/images/sarari-3.png'}" src="/images/sarari-3.png" alt="ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼">
          </div>
        </div>

		<aside class="level-stack dial-mode">
		  <div class="lv">Lv.<span th:text="${user.level}">1</span></div>

		  <!-- åŠå††ãƒ¡ãƒ¼ã‚¿ãƒ¼ï¼ˆ--p: 0ã€œ100ï¼‰ -->
		  <div class="dial" style="--p:35" th:style="'--p:' + ${user.expPercent}">
		    <svg viewBox="0 0 200 120" aria-label="ãƒ¬ãƒ™ãƒ«ãƒ¡ãƒ¼ã‚¿ãƒ¼">
		      <!-- åŠå††æ  -->
		      <path d="M10,110 A90,90 0 0 1 190,110" class="arc"></path>

			  <!-- ç›®ç››ã‚Šï¼ˆã‚¢ãƒ¼ãƒã«æ²¿ã†æ”¾å°„çŠ¶ï¼‰ -->
			  <g class="ticks">
			    <!-- å††ã®åŠå¾„ R=90ã€‚ã‚¢ãƒ¼ãƒè¿‘ãã«çŸ­ã„ç·šï¼ˆy=24ã€œ36ï¼‰ã‚’ç½®ã„ã¦å›è»¢ã•ã›ã‚‹ -->
			    <g transform="rotate(-75 100 110)"><line x1="100" y1="24" x2="100" y2="36"/></g>
			    <g transform="rotate(-60 100 110)"><line x1="100" y1="24" x2="100" y2="36"/></g>
			    <g transform="rotate(-45 100 110)"><line x1="100" y1="24" x2="100" y2="36"/></g>
			    <g transform="rotate(-30 100 110)"><line x1="100" y1="24" x2="100" y2="36"/></g>
			    <g transform="rotate(-15 100 110)"><line x1="100" y1="24" x2="100" y2="36"/></g>
			    <g transform="rotate(0   100 110)"><line x1="100" y1="24" x2="100" y2="36"/></g>
			    <g transform="rotate(15  100 110)"><line x1="100" y1="24" x2="100" y2="36"/></g>
			    <g transform="rotate(30  100 110)"><line x1="100" y1="24" x2="100" y2="36"/></g>
			    <g transform="rotate(45  100 110)"><line x1="100" y1="24" x2="100" y2="36"/></g>
			    <g transform="rotate(60  100 110)"><line x1="100" y1="24" x2="100" y2="36"/></g>
			    <g transform="rotate(75  100 110)"><line x1="100" y1="24" x2="100" y2="36"/></g>
			  </g>


		      <!-- é‡ï¼ˆä¸­å¿ƒã§å›è»¢ï¼‰ -->
		      <g class="needle">
		        <line x1="100" y1="110" x2="100" y2="36"/>
		        <circle cx="100" cy="110" r="6"/>
		      </g>
		    </svg>
		  </div>
		</aside>
		
		<a class="btn small diagnose-btn" th:href="@{/diagnose}" href="/diagnose">è¨ºæ–­ã™ã‚‹</a>

		<!-- å³ä¸Šãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ -->
		<details class="hamburger at-tr" aria-label="ãƒ¡ãƒ‹ãƒ¥ãƒ¼">
		  <summary class="hambtn" aria-label="ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ã">
		    <span class="bars" aria-hidden="true"></span>
		  </summary>

		  <!-- ã“ã“ãŒâ€œçœŸä¸‹ã«â€å±•é–‹ã•ã‚Œã‚‹ -->
		  <nav class="list">
		    <a href="/stats">ğŸ“Š è¨˜éŒ²</a>
		    <a href="/profile">ğŸªª ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è©³ç´°</a>
			<a href="/trophy">ğŸ† ç§°å·ãƒ»ã‚¢ã‚¤ãƒ†ãƒ ä¸€è¦§</a>
		    <a href="/settings">âš™ï¸ è¨­å®š</a>
		  </nav>
		</details>
		
      </section>

      <div class="meta">
        <span>v0.1.0</span>
      </div>
    </div>
  </main>

  <script>
    // ============ ãƒœã‚¿ãƒ³ã®æ³¢ç´‹ä½ç½®ã‚’ã‚«ãƒ¼ã‚½ãƒ«ã«åˆã‚ã›ã‚‹
    document.querySelectorAll('.btn').forEach(btn => {
      btn.addEventListener('pointerdown', e => {
        const rect = btn.getBoundingClientRect();
        btn.style.setProperty('--mx', `${e.clientX - rect.left}px`);
        btn.style.setProperty('--my', `${e.clientY - rect.top}px`);
      });
    });

    // ============ ã‚ãšã‹ãªãƒ‘ãƒ©ãƒ©ãƒƒã‚¯ã‚¹(èƒŒæ™¯å…¨ä½“)
    const stage = document.querySelector('.stage');
    const strength = 8; // px
    let rafId = null;
    function onMove(e){
      const x = (e.clientX / window.innerWidth - 0.5) * strength;
      const y = (e.clientY / window.innerHeight - 0.5) * strength;
      if(rafId) cancelAnimationFrame(rafId);
      rafId = requestAnimationFrame(() => {
        stage.style.backgroundPosition = `calc(50% + ${x}px) 80px, center`;
      });
    }
    window.addEventListener('pointermove', onMove);

    // ============ å®Ÿè£…æ™‚ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ç½®ãæ›ãˆãƒ•ãƒƒã‚¯
    document.getElementById('startBtn').addEventListener('click', (e) => {
      // TODO: ã“ã“ã‚’ãƒ•ãƒ­ãƒ³ãƒˆãƒ«ãƒ¼ã‚¿ãƒ¼é·ç§» or é€šå¸¸ã®ãƒªãƒ³ã‚¯å…ˆã«ç½®æ›
      // ä¾‹) location.href = '/play';
      // ä»Šã¯ãƒ‡ãƒ¢ãªã®ã§ã‚¢ãƒ³ã‚«ãƒ¼ã®ã¾ã¾
    });
      // ãƒ¬ãƒ™ãƒ«ã‚²ãƒ¼ã‚¸åˆæœŸåŒ–ï¼ˆdata-p ã‚’ width ã«åæ˜ ã—ã¦ã‚¢ãƒ‹ãƒ¡é–‹å§‹ï¼‰
    document.querySelectorAll('.levelbar .bar span').forEach(sp =>{
      const p = sp.getAttribute('data-p') || 0;
      sp.style.setProperty('--p', p + '%');
      sp.classList.add('gain');
    });
  </script>
</body>
</html>
